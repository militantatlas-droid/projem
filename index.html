<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Militan Atlası | Pro Dashboard</title>
  <style>
    :root {
      --bg-dark: #020617;
      --card-bg: rgba(15, 23, 42, 0.8);
      --accent: #10b981;
      --danger: #ef4444;
      --warning: #f59e0b;
      --text-main: #f8fafc;
      --border: rgba(255, 255, 255, 0.1);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      background: var(--bg-dark);
      color: var(--text-main);
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      height: 100vh;
      display: flex;
      overflow: hidden;
    }

    /* Sol Sidebar - Dashboard */
    #sidebar {
      width: 350px;
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-right: 1px solid var(--border);
      padding: 30px;
      display: flex;
      flex-direction: column;
      z-index: 100;
    }

    .header h1 { font-size: 22px; letter-spacing: 2px; color: var(--accent); margin-bottom: 5px; }
    .header p { font-size: 12px; opacity: 0.5; margin-bottom: 30px; }

    .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px; }
    .stat-item { background: rgba(0,0,0,0.4); padding: 15px; border-radius: 12px; border: 1px solid var(--border); }
    .stat-item small { font-size: 10px; text-transform: uppercase; opacity: 0.6; }
    .stat-item div { font-size: 20px; font-weight: bold; margin-top: 5px; }

    /* Harita Alanı */
    #map-wrapper {
      flex: 1;
      position: relative;
      background: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    svg { width: 90%; height: 90%; transition: transform 0.3s ease; }
    svg path { 
      fill: #1e293b; 
      stroke: #020617; 
      stroke-width: 0.5; 
      transition: all 0.2s ease; 
      cursor: crosshair;
    }
    svg path:hover { 
      filter: brightness(1.5); 
      stroke: var(--accent); 
      stroke-width: 1.5;
    }
    svg path.active { fill: var(--accent) !important; stroke: #fff; stroke-width: 2; }

    /* Tooltip */
    #map-tooltip {
      position: fixed;
      pointer-events: none;
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 13px;
      z-index: 1000;
      display: none;
      border: 1px solid var(--accent);
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    }

    /* Sağ Bilgi Kartı */
    #info-card {
      position: absolute;
      right: 30px;
      top: 30px;
      width: 380px;
      max-height: calc(100vh - 60px);
      background: var(--card-bg);
      backdrop-filter: blur(25px);
      border: 1px solid var(--border);
      border-radius: 24px;
      padding: 30px;
      transform: translateX(450px);
      transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
      overflow-y: auto;
    }
    #info-card.visible { transform: translateX(0); }

    .risk-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 50px;
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      margin-bottom: 15px;
    }
    .risk-high { background: rgba(239, 68, 68, 0.2); color: var(--danger); border: 1px solid var(--danger); }
    .risk-medium { background: rgba(245, 158, 11, 0.2); color: var(--warning); border: 1px solid var(--warning); }
    .risk-low { background: rgba(16, 185, 129, 0.2); color: var(--accent); border: 1px solid var(--accent); }

    .group-item {
      background: rgba(255,255,255,0.05);
      padding: 12px;
      border-radius: 10px;
      margin-top: 10px;
      border-left: 3px solid var(--accent);
    }
  </style>
</head>
<body>

  <div id="map-tooltip">Ülke İsmi</div>

  <aside id="sidebar">
    <div class="header">
      <h1>MİLİTAN ATLASI</h1>
      <p>AFRİKA OPERASYONEL VERİ PANELİ</p>
    </div>

    <div class="stat-grid">
      <div class="stat-item">
        <small>Aktif Odaklar</small>
        <div id="high-risk-count">12</div>
      </div>
      <div class="stat-item">
        <small>Bilinen Örgütler</small>
        <div id="total-groups-count">48</div>
      </div>
    </div>

    <div id="recent-activity" style="flex: 1;">
      <h3 style="font-size: 14px; margin-bottom: 15px; color: var(--accent);">Son Güncellemeler</h3>
      <div style="font-size: 12px; opacity: 0.7; line-height: 2;">
        • Sahel bölgesi hareketlilik arttı.<br>
        • Nijerya kuzeydoğu stabil.<br>
        • Somali operasyonları sürüyor.
      </div>
    </div>
  </aside>

  <main id="map-wrapper">
    <svg viewBox="0 0 1000 1000" id="main-svg">
        <path id="NG" d="..." /> </svg>

    <div id="info-card">
      <div id="risk-level" class="risk-badge">Risk Analizi</div>
      <h2 id="country-title" style="font-size: 28px; margin-bottom: 10px;">Ülke Seçin</h2>
      <p id="country-info" style="font-size: 14px; opacity: 0.8; margin-bottom: 20px;"></p>
      
      <h4 style="font-size: 14px; margin-bottom: 10px; border-top: 1px solid var(--border); pt: 15px;">Aktif Militan Gruplar</h4>
      <div id="groups-container"></div>
    </div>
  </main>

  <script>
    const tooltip = document.getElementById('map-tooltip');
    
    // 1. Veriyi Çek
    fetch('trdata.json')
      .then(res => res.json())
      .then(data => {
        const countries = data.countries;

        document.querySelectorAll('path').forEach(path => {
          const cData = countries[path.id];
          
          // Renklendirme
          if(cData) {
            if(cData.risk === 'high') path.style.fill = '#450a0a';
            if(cData.risk === 'medium') path.style.fill = '#451a03';
          }

          // HOVER: İsim Gösterme (Tooltip)
          path.addEventListener('mousemove', (e) => {
            const name = cData ? cData.name : path.id;
            tooltip.innerText = name;
            tooltip.style.display = 'block';
            tooltip.style.left = (e.clientX + 15) + 'px';
            tooltip.style.top = (e.clientY + 15) + 'px';
          });

          path.addEventListener('mouseleave', () => {
            tooltip.style.display = 'none';
          });

          // TIKLAMA: Detay Gösterme
          path.addEventListener('click', function() {
            document.querySelectorAll('path').forEach(p => p.classList.remove('active'));
            this.classList.add('active');

            if(cData) {
              showDetails(cData);
            }
          });
        });
      });

    function showDetails(data) {
      const card = document.getElementById('info-card');
      document.getElementById('country-title').innerText = data.name;
      document.getElementById('country-info').innerText = data.info;
      
      const riskBadge = document.getElementById('risk-level');
      riskBadge.innerText = data.risk.toUpperCase() + " RİSK";
      riskBadge.className = 'risk-badge risk-' + data.risk;

      const groupsHtml = data.groups.map(g => `
        <div class="group-item">
          <strong>${g}</strong><br>
          <small>Sektör: Operasyonel</small>
        </div>
      `).join('');
      
      document.getElementById('groups-container').innerHTML = groupsHtml || 'Kayıtlı grup yok.';
      card.classList.add('visible');
    }

    // Harita dışına tıklayınca kapat
    document.getElementById('map-wrapper').addEventListener('click', (e) => {
      if(e.target.tagName !== 'path') {
        document.getElementById('info-card').classList.remove('visible');
        document.querySelectorAll('path').forEach(p => p.classList.remove('active'));
      }
    });
  </script>
</body>
</html>
